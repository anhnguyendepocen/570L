#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass book
\use_default_options true
\begin_modules
knitr
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
Graphing using 
\family typewriter
ggplot2
\family default
: Lab 2
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE>>=
\end_layout

\begin_layout Plain Layout

opts_chunk$set(cache.path = './cache/Graphics',
\end_layout

\begin_layout Plain Layout

               fig.path   = './figure/Graphics')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Faceting
\end_layout

\begin_layout Standard
The goal with faceting is to make many panels of graphics where each panel
 represents the same relationship between variables, but something changes
 between each panel.
 For example using the 
\family typewriter
iris
\family default
 dataset we could look at the relationship between 
\family typewriter
Sepal.Length
\family default
 and 
\family typewriter
Petal.Length
\family default
 either with all the data in one graph, or one panel per species.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, fig.width=5, fig.height=2.5>>=
\end_layout

\begin_layout Plain Layout

library(ggplot2)
\end_layout

\begin_layout Plain Layout

ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) +
\end_layout

\begin_layout Plain Layout

  geom_point() +
\end_layout

\begin_layout Plain Layout

  facet_grid( .
 ~ Species )
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

The line 
\family typewriter
facet_grid( formula )
\family default
 tells 
\family typewriter
ggplot2
\family default
 to make panels, and the formula tells how to orient the panels.
 Recall that a formula is always in the order 
\family typewriter
y ~ x
\family default
 and because I want the species to change as we go across the page, but
 don't have anything I want to change vertically we use 
\family typewriter
.
 ~ Species
\family default
 to represent that.
 If we had wanted three graphs stacked then we could use 
\family typewriter
Species ~ .
\family default
.
 
\end_layout

\begin_layout Standard
For a second example, we look at a dataset that examines the amount a waiter
 was tipped by 244 parties.
 Covariates that were measured include the day of the week, size of the
 party, total amount of the bill, amount tipped, whether there were smokers
 in the group
\begin_inset Foot
status open

\begin_layout Plain Layout
Old data set when smoking in restaurants was allowed.
\end_layout

\end_inset

 and the gender of the person paying the bill
\begin_inset Foot
status open

\begin_layout Plain Layout
Mis-labeled as 
\family typewriter
sex
\family default
.
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, fig.width=5, fig.height=2.5>>=
\end_layout

\begin_layout Plain Layout

library(reshape2)
\end_layout

\begin_layout Plain Layout

data(tips)
\end_layout

\begin_layout Plain Layout

head(tips)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

It is easy to look at the relationship between the size of the bill and
 the percent tipped.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, fig.width=5, fig.height=2.5>>=
\end_layout

\begin_layout Plain Layout

# make a graph and save it as an object
\end_layout

\begin_layout Plain Layout

p2 <- ggplot(tips, aes(x = total_bill, y = tip / total_bill )) +
\end_layout

\begin_layout Plain Layout

  geom_point()
\end_layout

\begin_layout Plain Layout

# Now print the graph
\end_layout

\begin_layout Plain Layout

p2
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

Next we ask if there is a difference in tipping percent based on gender
 or day of the week by plotting this relationship for each combination of
 gender and day.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, fig.width=5, fig.height=2.5>>=
\end_layout

\begin_layout Plain Layout

p2 + facet_grid( sex ~ day )
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Sometimes we want multiple rows and columns of facets, but there is only
 one categorical variable with many levels.
 In that case we use 
\family typewriter
facet_wrap
\family default
 which takes a one-sided formula.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, fig.width=5, fig.height=2.5>>=
\end_layout

\begin_layout Plain Layout

p2 + facet_wrap( ~ day )
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Finally we can allow the x and y 
\family typewriter
scales
\family default
 to vary between the panels by setting 
\family typewriter

\begin_inset Quotes eld
\end_inset

free
\begin_inset Quotes erd
\end_inset


\family default
, 
\family typewriter

\begin_inset Quotes eld
\end_inset

free_x
\begin_inset Quotes erd
\end_inset


\family default
, or 
\family typewriter

\begin_inset Quotes eld
\end_inset

free_y
\begin_inset Quotes erd
\end_inset


\family default
.
 In the following code, the y-axis scale changes between the gender groups.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, fig.width=5, fig.height=2.5>>=
\end_layout

\begin_layout Plain Layout

p2 + facet_grid( sex ~ day, scales="free_y" )
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Multi-plot
\end_layout

\begin_layout Standard
Give a link to the multi-plot command
\end_layout

\begin_layout Section
Saving plots consistently
\end_layout

\begin_layout Standard
Use 
\family typewriter
ggsave()
\end_layout

\begin_layout Section
Themes
\end_layout

\begin_layout Standard
Show a few of my favorite themes.
 In part using the package 
\family typewriter
ggthemes
\end_layout

\begin_layout Enumerate
theme_bw()
\end_layout

\begin_layout Enumerate
theme_economist
\end_layout

\begin_layout Enumerate
theme_wsj
\end_layout

\begin_layout Enumerate
theme_excel - If you really must...
\end_layout

\begin_layout Section
Googling to get help
\end_layout

\end_body
\end_document
