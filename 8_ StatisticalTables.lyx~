#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass book
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
knitr
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
Using R for Statistical Tables
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE>>=
\end_layout

\begin_layout Plain Layout

opts_chunk$set(cache.path = './cache/StatisticalTables/',
\end_layout

\begin_layout Plain Layout

               fig.path   = './figure/StatisticalTables/')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset

Statistics makes use of a wide variety of distributions and before the days
 of personal computers, every statistician had books with hundreds and hundreds
 of pages of tables allowing them to look up particular values.
 Fortunately in the modern age, we don't need those books and tables, but
 we do still need to access those values.
 To make life easier and consistent for R users, every distribution is accessed
 in the same manner.
 
\end_layout

\begin_layout Section

\family typewriter
\series medium
\size normal
mosaic::plotDist()
\family default
 function
\end_layout

\begin_layout Standard
The 
\family typewriter
mosaic
\family default
 package provides a very useful routine for understanding a distribution.
 The 
\family typewriter
plotDist()
\family default
 function takes the R name of the distribution along with whatever parameters
 are necessary for that function and show the distribution.
 For reference below is a list of common distributions and their R name
 and a list of necessary parameters.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Distribution
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
R stem
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameters (and defaults)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
parameter interpretation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Binomial
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
binom
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
size
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
number of trials
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
prob
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
probability of success
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Poisson
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
pois
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
lambda
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mean of the distribution
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Exponential
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
exp
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
rate 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mean is 1/rate 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Normal
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
norm
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
mean=0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
mean
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
sd=1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
standard deviation
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="left" valignment="middle" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Uniform
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="left" valignment="middle" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
unif
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
min=0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
lower bound
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
max=1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
upper bound
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
For example, to see the normal distribution with mean 
\begin_inset Formula $\mu=10$
\end_inset

 and standard deviation 
\begin_inset Formula $\sigma=2$
\end_inset

, we use
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, warning=FALSE, fig.height=3, fig.width=5>>=
\end_layout

\begin_layout Plain Layout

library(mosaic)
\end_layout

\begin_layout Plain Layout

plotDist('norm', mean=10, sd=2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

This function works for discrete distributions as well
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, warning=FALSE, fig.height=3, fig.width=5>>=
\end_layout

\begin_layout Plain Layout

plotDist('binom', size=10, prob=.3)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Base R functions
\end_layout

\begin_layout Standard
All the probability distributions available in R are accessed in exactly
 the same way, using a 
\family typewriter
d-function
\family default
, 
\family typewriter
p-function
\family default
, 
\family typewriter
q-function
\family default
, and 
\family typewriter
r-function
\family default
.
 For the rest of this section suppose that 
\begin_inset Formula $X$
\end_inset

 is a random variable from the distribution of interest and 
\begin_inset Formula $x$
\end_inset

 is some possible value that 
\begin_inset Formula $X$
\end_inset

 could take on.
\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="2">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Function
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Result
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
d-function(x)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
the height of the probability distribution at 
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
p-function(x)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $P\left(X\le x\right)$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
q-function(q)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset

 such that 
\begin_inset Formula $P\left(X\le x\right)=q$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
r-function(n)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n$
\end_inset

 random observations from the distribution
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newline newline
\end_inset

Notice that the 
\family typewriter
p-function
\family default
 is the inverse of the 
\family typewriter
q-function
\family default
.
 
\end_layout

\begin_layout Standard
For each distribution in R, there will be be this set of functions but we
 replace the 
\begin_inset Quotes eld
\end_inset

-function
\begin_inset Quotes erd
\end_inset

 with the distribution name or a shortened version.
 
\family typewriter
norm, exp, binom, t, f
\family default
 are the names for the normal, exponential, binomial, T and F distributions.
 Furthermore, most distributions have additional parameters that define
 the distribution and will also be passed as arguments to these functions,
 although, if a reasonable default value for the parameter exists, there
 will be a default.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Subsection
d-function
\end_layout

\begin_layout Standard
The purpose of the d-function is to calculate the height of a probability
 mass function or a density function
\begin_inset Note Note
status open

\begin_layout Plain Layout
The 
\begin_inset Quotes eld
\end_inset

d
\begin_inset Quotes erd
\end_inset

 actually stands for density.
 
\end_layout

\end_inset

.
 Notice that for discrete distributions, this is the probability of observing
 that particular value, while for continuous distributions, the height doesn't
 have a nice physical interpretation.
\end_layout

\begin_layout Standard
We start with an example of the Binomial distribution.
 For 
\begin_inset Formula $X\sim Binomial\left(n=10,\pi=.2\right)$
\end_inset

 suppose we wanted to know 
\begin_inset Formula $P(X=0)$
\end_inset

? We know the probability mass function is 
\begin_inset Formula 
\[
P\left(X=x\right)={n \choose x}\pi^{x}\left(1-\pi\right)^{n-x}
\]

\end_inset

 thus
\family typewriter

\begin_inset Formula 
\begin{eqnarray*}
P\left(X=0\right) & = & {10 \choose 0}\,0.2^{0}\left(0.8\right)^{10}\\
 & = & 1\cdot1\cdot0.8^{10}\\
 & \approx & 0.107
\end{eqnarray*}

\end_inset


\family default
but that calculation is fairly tedious.
 To get R to do the same calculation, we just need the height of the probability
 mass function at 
\begin_inset Formula $0$
\end_inset

.
 To do this calculation, we need to know the 
\begin_inset Formula $x$
\end_inset

 value we are interested in along with the distribution parameters 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $\pi$
\end_inset

.
\end_layout

\begin_layout Standard
The first thing we should do is check the help file for the binomial distributio
n functions to see what parameters are needed and what they are named.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<eval=FALSE>>=
\end_layout

\begin_layout Plain Layout

?dbinom
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The help file shows us the parameters 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $\pi$
\end_inset

 are called 
\family typewriter
size
\family default
 and 
\family typewriter
prob
\family default
 respectively.
 So to calculate the probability that 
\begin_inset Formula $X=0$
\end_inset

 we would use the following command:
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

dbinom(0, size=10, prob=.2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
p-function
\end_layout

\begin_layout Standard
Often we are interested in the probability of observing some value or anything
 less
\begin_inset Note Note
status open

\begin_layout Plain Layout
In probability theory, we call this the cumulative density function or CDF.
 
\end_layout

\end_inset

.
 P-values will be calculated this way, so we want a nice easy way to do
 this.
\end_layout

\begin_layout Standard
To start our example with the binomial distribution, again let 
\begin_inset Formula $X\sim Binomial\left(n=10,\pi=0.2\right)$
\end_inset

.
 Suppose I want to know what the probability of observing a 0, 1, or 2?
 That is, what is 
\begin_inset Formula $P\left(X\le2\right)$
\end_inset

? I could just find the probability of each and add them up.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

dbinom(0, size=10, prob=.2)   +  
\end_layout

\begin_layout Plain Layout

  dbinom(1, size=10, prob=.2) + 
\end_layout

\begin_layout Plain Layout

  dbinom(2, size=10, prob=.2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

but this would get tedious for binomial distributions with a large number
 of trials.
 The shortcut is to use the 
\family typewriter
pbinom()
\family default
 function.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

pbinom(2, size=10, prob=.2)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For discrete distributions, you must be careful because R will give you
 the probability of 
\emph on
less than or equal to 2
\emph default
.
 If you wanted less than two, you should use 
\family typewriter
dbinom(1,10,.2)
\family default
.
 
\end_layout

\begin_layout Standard
The normal distribution works similarly.
 Suppose for 
\begin_inset Formula $Z\sim N\left(0,1\right)$
\end_inset

 and we wanted to know 
\begin_inset Formula $P\left(Z\le-1\right)$
\end_inset

? 
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=3, fig.width=5>>=
\end_layout

\begin_layout Plain Layout

z <- seq(-4,4,by=.01)
\end_layout

\begin_layout Plain Layout

heights <- dnorm(z)
\end_layout

\begin_layout Plain Layout

plot(z, heights, type='l', ylab='density', xlab='Z')
\end_layout

\begin_layout Plain Layout

z2 <- seq(-4,-1, by=.01)
\end_layout

\begin_layout Plain Layout

y2 <- dnorm(z2)
\end_layout

\begin_layout Plain Layout

polygon(c(-4,z2,-1),c(0,y2,0), col='grey')
\end_layout

\begin_layout Plain Layout

text(-2.5, .135, 'P(Z < -1)')
\end_layout

\begin_layout Plain Layout

axis(1, -1, labels=-1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

The answer is easily found via 
\family typewriter
pnorm()
\family default

\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

pnorm(-1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

Notice for continuous random variables, the probability 
\begin_inset Formula $P\left(Z=-1\right)=0$
\end_inset

 so we can ignore the issue of 
\begin_inset Quotes eld
\end_inset

less than
\begin_inset Quotes erd
\end_inset

 vs 
\begin_inset Quotes eld
\end_inset

less than or equal to
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
Often times we will want to know the probability of 
\emph on
greater than 
\emph default
some value.
 That is, we might want to find 
\begin_inset Formula $P\left(Z\ge1\right)$
\end_inset

.
 For the normal distribution, there are a number of tricks we could use.
 Notably
\begin_inset Formula 
\begin{eqnarray*}
P\left(Z\ge-1\right) & = & P\left(Z\le1\right)=1-P\left(Z<-1\right)
\end{eqnarray*}

\end_inset

but sometimes I'm lazy and would like to tell R to give me the area to the
 right instead of area to the left (which is the default).
 This can be done by setting the argument 
\family typewriter
lower.tail=FALSE
\family default
.
\end_layout

\begin_layout Standard
The 
\family typewriter
mosaic
\family default
 package includes an augmented version of the 
\family typewriter
pnorm()
\family default
 function called 
\family typewriter
xpnorm()
\family default
 that calculates the same number but includes some extra information and
 produces a pretty graph to help us understand what we just calculated and
 do the tedious 
\begin_inset Quotes eld
\end_inset

1 minus
\begin_inset Quotes erd
\end_inset

 calculation to find the upper area.
\begin_inset Foot
status open

\begin_layout Plain Layout
Fortunately this 
\family typewriter
\size normal
x-
\family default
variant exists for the Normal, Chi-squared, F, Gamma continuous distributions
 and the discrete Poisson, Geometric, and Binomial normal distribution.
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig.height=3.5, fig.width=5>>=
\end_layout

\begin_layout Plain Layout

library(mosaic)
\end_layout

\begin_layout Plain Layout

xpnorm(-1)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
q-function
\end_layout

\begin_layout Standard
In class, we will also find ourselves asking for the quantiles
\begin_inset Note Note
status open

\begin_layout Plain Layout
Percentiles are by definition 1/100, 2/100, etc but if I am interested in
 something that isn't and even division of 100, we get fancy can call them
 quantiles.
 This is a small semantic quibble, but we ought to be precise.
 That being said, I won't correct somebody if they call these percentiles.
\end_layout

\end_inset

 of a distribution.
 For example, I might want to find the 
\begin_inset Formula $0.30$
\end_inset

 quantile, which is the value such that 
\begin_inset Formula $30\%$
\end_inset

 of the distribution is less than it, and 
\begin_inset Formula $70\%$
\end_inset

 is greater.
 Mathematically, I wish to find the value 
\begin_inset Formula $z$
\end_inset

 such that 
\begin_inset Formula $P(Z<z)=0.30$
\end_inset

.
 
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<echo=FALSE, fig.height=3, fig.width=5>>=
\end_layout

\begin_layout Plain Layout

z <- seq(-4,4,by=.01)
\end_layout

\begin_layout Plain Layout

heights <- dnorm(z)
\end_layout

\begin_layout Plain Layout

plot(z, heights, type='l', ylab='density', xlab='Z')
\end_layout

\begin_layout Plain Layout

zstar <- qnorm(.30)
\end_layout

\begin_layout Plain Layout

z2 <- seq(-4,zstar, by=.01)
\end_layout

\begin_layout Plain Layout

y2 <- dnorm(z2)
\end_layout

\begin_layout Plain Layout

polygon(c(-4,z2,zstar),c(0,y2,0), col='grey')
\end_layout

\begin_layout Plain Layout

text(-1,.10, '30%')
\end_layout

\begin_layout Plain Layout

text(.5, .20, '70%')
\end_layout

\begin_layout Plain Layout

axis(1, at=zstar, labels='z')
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
To find this value in the tables in the book, we use the table in reverse.
 R gives us a handy way to do this with the 
\family typewriter
qnorm()
\family default
 function.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

qnorm(0.30)
\end_layout

\begin_layout Plain Layout

# if we take that and stuff it back into the 
\end_layout

\begin_layout Plain Layout

# pnorm() function, we should get 0.30 back out again
\end_layout

\begin_layout Plain Layout

pnorm(-0.5244005)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\family typewriter
mosaic
\family default
 package also provides an augmented version of the 
\family typewriter
qnorm()
\family default
 function named 
\family typewriter
xqnorm()
\family default
 that calculates the same value but also includes a nice graph to help us
 understand what we just calculated.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig.height=3, fig.width=5>>=
\end_layout

\begin_layout Plain Layout

xqnorm(0.30)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
r-function
\end_layout

\begin_layout Standard
Finally, I often want to be able to generate random data from a particular
 distribution.
 R does this with the r-function.
 The first argument to this function the number of random variables to draw
 and any remaining arguments are the parameters of the distribution.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<>>=
\end_layout

\begin_layout Plain Layout

rnorm(5, mean=20, sd=2)
\end_layout

\begin_layout Plain Layout

rbinom(4, size=10, prob=.8)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Plotting distributions using ggplot2
\end_layout

\begin_layout Standard
Often I need to plot a distribution and perhaps shade some area in.
 In this section we'll give a method for plotting continuous and discrete
 distributions using 
\family typewriter
ggplot2
\family default
.
\end_layout

\begin_layout Subsection
Continuous distributions
\end_layout

\begin_layout Standard
First we need to create a 
\family typewriter
data.frame
\family default
 that contains a sequence of (x,y) pairs that we'll pass to our graphing
 program to draw the curve by connecting-the-dots, but because the dots
 will be very close together, the resulting curve looks smooth.
 For example, lets plot the F-distribution with parameters 
\begin_inset Formula $\nu_{1}=5$
\end_inset

 and 
\begin_inset Formula $\nu_{2}=30$
\end_inset

.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<message=FALSE, warning=FALSE, fig.height=3>>=
\end_layout

\begin_layout Plain Layout

library(dplyr)
\end_layout

\begin_layout Plain Layout

library(ggplot2)
\end_layout

\begin_layout Plain Layout

plot.data <- data.frame( x=seq(0,10, length=1000) ) %>%
\end_layout

\begin_layout Plain Layout

  mutate( density = df(x, 5, 30) )
\end_layout

\begin_layout Plain Layout

ggplot(plot.data, aes(x=x, y=density)) +
\end_layout

\begin_layout Plain Layout

  geom_line()
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This isn't too bad, but often we want to add some color to two different
 sections, perhaps we want different colors distinguishing between values
 
\begin_inset Formula $\ge2.5$
\end_inset

 vs values 
\begin_inset Formula $<2.5$
\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig.height=3>>=
\end_layout

\begin_layout Plain Layout

plot.data <- data.frame( x=seq(0,10, length=1000) ) %>%
\end_layout

\begin_layout Plain Layout

  mutate( density = df(x, 5, 30),
\end_layout

\begin_layout Plain Layout

          Group = ifelse(x <= 2.5, 'Less','Greater') )
\end_layout

\begin_layout Plain Layout

ggplot(plot.data, aes(x=x, y=density, fill=Group)) +
\end_layout

\begin_layout Plain Layout

  geom_area() +
\end_layout

\begin_layout Plain Layout

  geom_line() 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Discrete distributions
\end_layout

\begin_layout Standard
The idea for discrete distributions will be to draw points for the height
 and then add bars.
 Lets look at doing this for the poisson distribution with rate parameter
 
\begin_inset Formula $\lambda=2$
\end_inset

.
\begin_inset Newline newline
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "100col%"
special "none"
height "1in"
height_special "totalheight"
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout

<<fig.height=3>>=
\end_layout

\begin_layout Plain Layout

plot.data <- data.frame( x=seq(0,10) ) %>%
\end_layout

\begin_layout Plain Layout

  mutate( probability = dpois(x, lambda=2) )
\end_layout

\begin_layout Plain Layout

ggplot(plot.data, aes(x=x)) +
\end_layout

\begin_layout Plain Layout

  geom_point( aes(y=probability) ) +
\end_layout

\begin_layout Plain Layout

  geom_linerange(aes(ymax=probability), ymin=0) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Exercises
\end_layout

\begin_layout Enumerate
We will examine how to use the probability mass functions (a.k.a.
 d-functions) and cumulative probability function (a.k.a.
 p-function) for the Poisson distribution.
\end_layout

\begin_deeper
\begin_layout Enumerate
Create a graph of the distribution of a Poisson random variable with rate
 parameter 
\begin_inset Formula $\lambda=2$
\end_inset

 using the 
\family typewriter
mosaic
\family default
 function 
\family typewriter
plotDist()
\family default
.
\end_layout

\begin_layout Enumerate
Calculate the probability that a Poisson random variable (with rate parameter
 
\begin_inset Formula $\lambda=2$
\end_inset

) is exactly equal to 3 using the 
\family typewriter
dpois()
\family default
 function.
 Be sure that this value matches the graphed distribution in part (a).
\end_layout

\begin_layout Enumerate
For a Poisson random variable with rate parameter 
\begin_inset Formula $\lambda=2$
\end_inset

, calculate the probability it is less than or equal to 3, by summing the
 four values returned by the Poisson d-function.
\end_layout

\begin_layout Enumerate
Perform the same calculation as the previous question but using the cumulative
 probability function 
\family typewriter
ppois()
\family default
 or the 
\family typewriter
mosaic
\family default
 function 
\family typewriter
xppois()
\family default
.
\end_layout

\end_deeper
\begin_layout Enumerate
We will examine how to use the cumulative probability functions (a.k.a.
 p-functions) for the normal distributions.
\end_layout

\begin_deeper
\begin_layout Enumerate
Use the 
\family typewriter
mosaic
\family default
 function 
\family typewriter
plotDist()
\family default
 to produce a graph of the standard normal distribution.
\end_layout

\begin_layout Enumerate
For a standard normal, use the 
\family typewriter
pnorm()
\family default
 function or its 
\family typewriter
mosaic
\family default
 augmented version 
\family typewriter
xpnorm()
\family default
 to calculate
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $P\left(Z<-1\right)$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $P\left(Z\ge1.5\right)$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Use the 
\family typewriter
mosaic
\family default
 function 
\family typewriter
plotDist()
\family default
 to produce a graph of an exponential distribution with 
\family typewriter
rate
\family default
 parameter 2.
\end_layout

\begin_layout Enumerate
Suppose that 
\begin_inset Formula $Y\sim Exp\left(2\right)$
\end_inset

, as above, use the 
\family typewriter
pexp()
\family default
 function to calculate 
\begin_inset Formula $P\left(Y\le1\right)$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Enumerate
We next examine how to use the quantile functions for the normal and exponential
 distributions using R's q-functions.
\end_layout

\begin_deeper
\begin_layout Enumerate
Find the value of a standard normal distribution (
\begin_inset Formula $\mu=0$
\end_inset

, 
\begin_inset Formula $\sigma=1$
\end_inset

) such that 
\begin_inset Formula $5\%$
\end_inset

 of the distribution is to the left of the value using the 
\family typewriter
qnorm()
\family default
 function or the 
\family typewriter
mosaic
\family default
 augmented version 
\family typewriter
xqnorm()
\family default
.
\end_layout

\begin_layout Enumerate
Find the value of an exponential distribution with rate 
\begin_inset Formula $2$
\end_inset

 such that 
\begin_inset Formula $60\%$
\end_inset

 of the distribution is less than it using the 
\family typewriter
qexp()
\family default
 function.
\end_layout

\end_deeper
\begin_layout Enumerate
Finally we will look at generating random deviates from a distribution.
\end_layout

\begin_deeper
\begin_layout Enumerate
Generate a value of 1 from a uniform distribution with minimum 0, and maximum
 1 using the 
\family typewriter
runif()
\family default
 function.
 Repeat this step several times and confirm you are getting different values
 each time.
\end_layout

\begin_layout Enumerate
Generate a sample of size 20 from the same uniform distribution and save
 it as a column in a data frame.
 Then produce a histogram of the sample using the 
\family typewriter
mosaic
\family default
 function 
\family typewriter
histogram()
\family default
.
 
\end_layout

\begin_layout Enumerate
Generate a sample of 2000 from a normal distribution with 
\family typewriter
mean=10
\family default
 and standard deviation 
\family typewriter
sd=2
\family default
 using the 
\family typewriter
rnorm()
\family default
 function.
 Create a histogram the the resulting sample.
\end_layout

\end_deeper
\end_body
\end_document
